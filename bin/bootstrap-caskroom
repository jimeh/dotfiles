#! /usr/bin/env bash
set -e

pkgs=()

if [[ " $@ " == " home " ]]; then
  pkgs+=(
    adium-beta
    android-file-transfer
    audio-hijack
    autodmg
    bowtie
    calibre
    cloudup
    daisydisk
    deluge
    discord
    dropbox
    ethereum-wallet
    filebot
    gog-galaxy
    gpgtools
    hackety-hack
    handbrake
    irccloud
    keybase
    little-snitch
    logitech-options
    makemkv
    messenger
    micro-snitch
    mist
    omnigraffle
    openemu
    parallels-desktop
    plex-media-player
    ring
    screenhero
    sixtyforce
    skype
    spotify
    # synology-assistant
    teamviewer
    transmission
    unetbootin
    virtualbox
    virtualc64
    viscosity
    vmware-fusion
    witgui
    xld
    yakyak
    ynab
  )
fi

if [[ " $@ " == " work " ]]; then
  pkgs+=(
    aerial
    alfred
    appcleaner
    atom
    bartender
    bbedit
    betterzip
    betterzipql
    caskroom/drivers/logitech-options
    chicken
    cyberduck
    docker-edge
    firefox
    fluid
    flux
    github-desktop
    google-chrome
    google-cloud-sdk
    hipchat
    insomnia
    istat-menus
    istumbler
    iterm2
    java
    kaleidoscope
    karabiner-elements
    licecap
    medis
    moom
    mplayerx
    paw
    postman
    qlcolorcode
    qlimagesize
    qlmarkdown
    qlprettypatch
    qlstephen
    qlvideo
    quicklook-csv
    quicklook-json
    quicklookapk
    resolutionator
    sequel-pro
    stay
    suspicious-package
    ubersicht
    visual-studio-code
    vlc
    webpquicklook
  )
fi

installed=( $(brew cask list) )

for pkg in "${pkgs[@]}"; do
  base=$(echo $pkg | awk '{print $1}')
  if [[ "$base" == *\/* ]]; then
     base=$(basename "$base")
  fi

  found=""

  for i in ${installed[@]}; do
    if [[ "$base" == "$i" ]]; then
      found=1
    fi
  done

  if [ -z "$found" ]; then
    echo "--> Missing: ${base}"
    brew cask install ${pkg[@]}
  else
    echo "--> Installed: ${base}"
  fi
done
